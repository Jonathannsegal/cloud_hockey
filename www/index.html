<!doctype html>
<head>
<link rel="stylesheet" href="/www/style.css">
<script src="https://www.gstatic.com/firebasejs/5.8.4/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.8.5/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.8.4/firebase-firestore.js"></script>
<script src="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.css" />
</head>

<body>
  <div id="firebaseui-auth-container"></div>
  <h1>Hockey Stick</h1>
  <div>
      <p id="tS">TimeStamp: 0</p>
      <br>
      <p id="gX">gryro X: 0</p>
      <p id="gY">gryro Y: 0</p>
      <p id="gZ">gryro Z: 0</p>
      <p id="aX">acceleration X: 0</p>
      <p id="aY">acceleration Y: 0</p>
      <p id="aZ">acceleration Z: 0</p>
    </div>
</body>

<script>
firebase.initializeApp({
  apiKey: 'AIzaSyBLqPvIYIL-Bf-W7cBteUDmtRhRSdZ0qGc',
  authDomain: 'cloudhockey-233308.firebaseapp.com',
  projectId: 'cloudhockey-233308'
});

var db = firebase.firestore();
var provider = new firebase.auth.GoogleAuthProvider();
var user = firebase.auth().currentUser;

//Authentication
if (user) {
  // User is signed in.
  alert("signed in");
} else {
  // No user is signed in.
    // FirebaseUI config.
    var uiConfig = {
    signInSuccessUrl: '<url-to-redirect-to-on-success>',
    signInOptions: [
      // Leave the lines as is for the providers you want to offer your users.
      firebase.auth.GoogleAuthProvider.PROVIDER_ID,
    ],
    // tosUrl and privacyPolicyUrl accept either url string or a callback
    // function.
    // Terms of service url/callback.
    tosUrl: '<your-tos-url>',
    // Privacy policy url/callback.
    privacyPolicyUrl: function() {
      window.location.assign('<your-privacy-policy-url>');
    }
  };
}


  // Initialize the FirebaseUI Widget using Firebase.
  var ui = new firebaseui.auth.AuthUI(firebase.auth());
  // The start method will wait until the DOM is loaded.
  ui.start('#firebaseui-auth-container', uiConfig);

  firebase.auth().signInWithPopup(provider).then(function(result) {
  // This gives you a Google Access Token. You can use it to access the Google API.
  var token = result.credential.accessToken;
  // The signed-in user info.
  user = result.user;
  console.log(result.user);
  // ...
}).catch(function(error) {
  // Handle Errors here.
  var errorCode = error.code;
  var errorMessage = error.message;
  // The email of the user's account used.
  var email = error.email;
  // The firebase.auth.AuthCredential type that was used.
  var credential = error.credential;
  // ...
});




let gryro = new Gyroscope();
gryro.start();

let acceleration = new Accelerometer();
acceleration.start();

var user1 = db.collection("users").doc("PI8sAlqTPs2bO1ZUtOZO");

gryro.onreading = () => {
  user1.update({
    timestamp: gryro.timestamp,
    gryrox: gryro.x,
    gryroy: gryro.y,
    gryroz: gryro.z,
    accelerationx: acceleration.x,
    accelerationy: acceleration.y,
    accelerationz: acceleration.z
  })
    document.getElementById("tS").textContent="TimeStamp " + gryro.timestamp;

    document.getElementById("gX").textContent="gryro X-axis " + gryro.x;
    document.getElementById("gY").textContent="gryro Y-axis " + gryro.y;
    document.getElementById("gZ").textContent="gryro Z-axis " + gryro.z;

    document.getElementById("aX").textContent="acceleration X-axis " + acceleration.x;
    document.getElementById("aY").textContent="acceleration Y-axis " + acceleration.y;
    document.getElementById("aZ").textContent="acceleration Z-axis " + acceleration.z;
};


gryro.onerror = event => console.log(event.error.name, event.error.message);
acceleration.onerror = event => console.log(event.error.name, event.error.message);
</script>

</html>
